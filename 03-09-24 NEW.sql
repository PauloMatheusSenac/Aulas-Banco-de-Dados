CREATE DATABASE vendas;
USE vendas;

-- Tabelas
CREATE TABLE CIDADE (
    CODCID   INTEGER NOT NULL PRIMARY KEY,
    NOMECID  VARCHAR(60) NOT NULL,
    UF       CHAR(2) NOT NULL
);

CREATE TABLE CLIENTE (
    CODCLI    INTEGER NOT NULL PRIMARY KEY,
    NOME      VARCHAR(60) NOT NULL,
    ENDERECO  VARCHAR(60),
    CODCID    INTEGER NOT NULL,
    CEP       CHAR(10),
    CPF       CHAR(20),
    FOREIGN KEY (CODCID) REFERENCES CIDADE (CODCID)
);

CREATE TABLE ITEMPEDIDO (
    NUMPED   INTEGER NOT NULL,
    CODPROD  INTEGER NOT NULL,
    QTDADE   SMALLINT NOT NULL,
    PRIMARY KEY (NUMPED, CODPROD),
    FOREIGN KEY (NUMPED) REFERENCES PEDIDO (NUMPED),
    FOREIGN KEY (CODPROD) REFERENCES PRODUTO (CODPROD)
);

CREATE TABLE PEDIDO (
    NUMPED   INTEGER NOT NULL PRIMARY KEY,
    ENTREGA  SMALLINT,
    CODCLI   INTEGER,
    CODVEND  INTEGER,
    FOREIGN KEY (CODCLI) REFERENCES CLIENTE (CODCLI),
    FOREIGN KEY (CODVEND) REFERENCES VENDEDOR (CODVEND)
);

CREATE TABLE PRODUTO (
    CODPROD    INTEGER NOT NULL PRIMARY KEY,
    DESCRICAO  VARCHAR(25) NOT NULL,
    UNIDADE    CHAR(3) NOT NULL,
    VALOR_UN   NUMERIC(10,2) NOT NULL
);

CREATE TABLE SETOR (
    CODSETOR   INTEGER NOT NULL PRIMARY KEY,
    NOMESETOR  VARCHAR(50) NOT NULL
);

CREATE TABLE VENDEDOR (
    CODVEND   INTEGER NOT NULL PRIMARY KEY,
    NOMEVEND  VARCHAR(60) NOT NULL,
    CODSETOR  INTEGER,
    SALARIO   NUMERIC(10,2) NOT NULL,
    FOREIGN KEY (CODSETOR) REFERENCES SETOR (CODSETOR)
);

-- Dados
INSERT INTO CIDADE (CODCID, NOMECID, UF) VALUES 
(1, 'DOURADOS', 'MS'),
(2, 'CAMPO GRANDE', 'MS'),
(3, 'SÃO PAULO', 'SP'),
(4, 'CUIABA', 'MT'),
(5, 'FLORIANÓPOLIS', 'SC'),
(6, 'SÃO SEBASTIÃO', 'SC'),
(7, 'CAARAPÓ', 'MS'),
(8, 'BRASÍLIA', 'DF'),
(10, 'TUPÃ', 'SP'),
(11, 'SÃO JOSÉ DO RIO PRETO', 'SP'),
(12, 'APUCARANA', 'PR'),
(13, 'JARDIM', 'MS'),
(14, 'JATEI', 'MS'),
(15, 'AMAMBAI', 'MS');

INSERT INTO CLIENTE (CODCLI, NOME, ENDERECO, CODCID, CEP, CPF) VALUES 
(1, 'Nicolash Pereira Rodrigues', 'Rua José Germano, 1456', 1, '13971-150', '139.711.500-00'),
(2, 'Cauã Oliveira Azevedo', 'Rua Luís Squilace, 175', 3, '05326-010', '855.498.901-51'),
(3, 'Martim Melo Araujo', 'Rua de Mizar, 429', 2, '32550-220', '421.837.827-49'),
(4, 'Matheus Pinto Almeida', 'Travessa Getúlio Vargas, 1426', 4, '54250-382', NULL),
(5, 'Estevan Pereira Cardoso', 'Travessa Maria da Penha Costa, 692', 5, '29707-190', '231.416.173-41'),
(6, 'Rebeca Sousa Fernandes', 'Avenida da Saudade, 1899', 3, '09030-030', NULL),
(7, 'Thaís Melo Rodrigues', 'Rua N, 1379', 11, '35900-626', '884.501.839-36'),
(8, 'Matheus Martins Ribeiro', 'Rua Ubaldo Damiano, 1006', 1, '17204-281', NULL),
(9, 'Leonardo Barros Melo', 'Rua Treze de Maio, 808', 2, '65900-220', '735.643.235-89'),
(10, 'Emilly Rocha Ribeiro', 'Passagem Santa Luzia, 221', 1, '66117-060', '613.666.706-12'),
(11, 'Luan Goncalves Melo', 'Rua Chapada Velha, 944', 3, '05728-070', '656.106.888-25'),
(12, 'Júlia Gomes Araujo', 'Rua Alamanda, 751', 3, '06728-320', '184.206.138-00'),
(13, 'Camila Rodrigues Barbosa', 'Rua dos Cumarus, 1977', 2, '38703-678', '973.600.869-06'),
(14, 'Melissa Araujo Almeida', 'Rua 104A, 1820', 1, '74083-310', '677.324.633-40'),
(15, 'Laura Barros Rodrigues', 'Rua Doutor Muraí, 697', 3, '03159-080', '670.936.770-37');


INSERT INTO SETOR (CODSETOR, NOMESETOR) VALUES 
(1, 'JARDIM'),
(2, 'VENENOS'),
(3, 'PEÇAS'),
(4, 'FERRAMENTAS'),
(5, 'VACINAS'),
(6, 'VESTUÁRIO');

INSERT INTO VENDEDOR (CODVEND, NOMEVEND, CODSETOR, SALARIO) VALUES 
(1, 'ANTONIO CARLOS DA SILVA', 1, 500),
(2, 'ROGERIO SANTOS AMADO', 1, 550),
(3, 'JOÃO FLORISVALDO JESUS', 2, 800),
(4, 'PEDRO CELESTINO VENÂNCIO', 3, 1000),
(5, 'JAIR COSTA', 3, 1000),
(6, 'ELIZA DOS ANJOS', 4, 700),
(7, 'DENIS OTTANO', 5, 600),
(8, 'RONEI ARAÚJO BATISTA', 6, 400),
(9, 'JAMES CHEN VILAREAL', 6, 400),
(10, 'FABIO BENDITO REIS', 4, 700),
(11, 'EDILSON NOGUEIRA', 2, 800),
(12, 'RODOLFO DOS SANTOS', 4, 450),
(13, 'CRISTIANE ANTUNES ROCHA', 3, 450),
(14, 'CRISLAINE RUBENS AZEVEDO', 1, 500),
(15, 'JADER DE AMARO', 4, 1500);

INSERT INTO PEDIDO (NUMPED, ENTREGA, CODCLI, CODVEND) VALUES 
(1, 5, 1, 3),
(2, 2, 2, 5),
(3, 10, 4, 1),
(4, 20, 1, 2),
(5, 2, 8, 9),
(6, 2, 2, 4),
(7, 10, 5, 7),
(8, 2, 14, 11),
(9, 5, 15, 15),
(10, 5, 15, 4),
(11, 20, 9, 10),
(12, 10, 9, 11),
(13, 1, 5, 6),
(14, 1, 13, 9),
(15, 20, 12, 5);

INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (1, 'MATA CUPIM', 'UN ', 25);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (2, 'GLIFOSSATO', 'UN ', 12);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (3, 'RANDAP', 'UN ', 33);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (4, 'SERRA CIRCULAR', 'UN ', 200);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (5, 'ROÇADEIRA', 'UN ', 378);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (6, 'MOTO SERRA', 'UN ', 400);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (7, 'CORTADOR DE GRAMA', 'UN ', 800);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (8, 'PÁ DE PONTA', 'UN ', 70);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (9, 'VACINA BDD', 'CX ', 299);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (10, 'VACINA DDD', 'CX ', 200);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (11, 'MASCARA', 'UN ', 5);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (12, 'MASCARA SILICONE', 'UN ', 10);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (13, 'PINO CORTADOR', 'UN ', 5);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (14, 'ROSCA SERRA 22', 'UN ', 12);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (15, 'MANGUEIRA 04', 'M  ', 25);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (16, 'BICO MANGUEIRA', 'UN ', 3);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (17, 'ROUPA PROTECAO', 'UN ', 53);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (18, 'PULVERIZADOR', 'UN ', 76);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (19, 'CHAPEU DE PALHA', 'UN ', 34);
INSERT INTO PRODUTO (CODPROD, DESCRICAO, UNIDADE, VALOR_UN) VALUES (20, 'LUVA DE BORRACHA', 'UN ', 2);


INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (1, 1, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (1, 3, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (1, 10, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (2, 4, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (3, 2, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (3, 3, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (4, 9, 5);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (4, 11, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (4, 12, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (5, 2, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (5, 11, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (5, 18, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (5, 20, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (6, 5, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (7, 7, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (8, 8, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (10, 2, 2);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (10, 12, 3);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (10, 17, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (10, 18, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (10, 19, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (13, 8, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (13, 19, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (13, 20, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (14, 13, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (14, 17, 1);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (15, 15, 20);
INSERT INTO ITEMPEDIDO (NUMPED, CODPROD, QTDADE) VALUES (15, 16, 1);

-- 1. Quantas cidades tem cadastradas no banco?
SELECT COUNT(*) AS total_cidades FROM CIDADE;

-- 2. Quantos clientes tem cadastrados no banco?
SELECT COUNT(*) AS total_clientes FROM CLIENTE;

-- 3. Quantos produtos tem no banco?
SELECT COUNT(*) AS total_produtos FROM PRODUTO;

-- 4. Quantos setores tem no banco?
SELECT COUNT(*) AS total_setores FROM SETOR;

-- 5. Quantos pedidos tem no banco?
SELECT COUNT(*) AS total_pedidos FROM PEDIDO;

-- 6. Qual o maior salário dos vendedores?
SELECT MAX(SALARIO) AS maior_salario FROM VENDEDOR;

-- 7. Quem possui o maior salário?
SELECT NOMEVEND, SALARIO
FROM VENDEDOR
WHERE SALARIO = (SELECT MAX(SALARIO) FROM VENDEDOR);

-- 8. Qual o menor salário dos vendedores?
SELECT MIN(SALARIO) AS menor_salario FROM VENDEDOR;

-- 9. Quem possui o menor salário?
SELECT NOMEVEND, SALARIO
FROM VENDEDOR
WHERE SALARIO = (SELECT MIN(SALARIO) FROM VENDEDOR);

-- 10. Qual pedido teve a maior venda em quantidade?
SELECT NUMPED, SUM(QTDADE) AS total_quantidade
FROM ITEMPEDIDO
GROUP BY NUMPED
ORDER BY total_quantidade DESC
LIMIT 1;

-- 11. Qual pedido teve a menor venda em quantidade?
SELECT NUMPED, SUM(QTDADE) AS total_quantidade
FROM ITEMPEDIDO
GROUP BY NUMPED
ORDER BY total_quantidade ASC
LIMIT 1;

-- 12. Qual o produto mais barato?
SELECT DESCRICAO, VALOR_UN
FROM PRODUTO
ORDER BY VALOR_UN ASC
LIMIT 1;

-- 13. Qual o produto mais caro?
SELECT DESCRICAO, VALOR_UN
FROM PRODUTO
ORDER BY VALOR_UN DESC
LIMIT 1;

-- 14. Quantos vendedores existem no setor de ferramentas?
SELECT COUNT(*) AS total_vendedores_setor_ferramentas
FROM VENDEDOR
WHERE CODSETOR = (SELECT CODSETOR FROM SETOR WHERE NOMESETOR = 'FERRAMENTAS');

-- 15. Quantos pedidos o cliente Estevan Pereira Cardoso fez?
SELECT COUNT(*) AS total_pedidos_cliente
FROM PEDIDO
WHERE CODCLI = (SELECT CODCLI FROM CLIENTE WHERE NOME = 'Estevan Pereira Cardoso');
